<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Heatmaps | Learning LogBook Tree phenology analysis with R</title>
  <meta name="description" content="Chapter 15 Heatmaps | Learning LogBook Tree phenology analysis with R." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Heatmaps | Learning LogBook Tree phenology analysis with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 15 Heatmaps | Learning LogBook Tree phenology analysis with R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Heatmaps | Learning LogBook Tree phenology analysis with R" />
  
  <meta name="twitter:description" content="Chapter 15 Heatmaps | Learning LogBook Tree phenology analysis with R." />
  

<meta name="author" content="Philipp MÃ¼nker" />


<meta name="date" content="2023-01-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chill-model-comparison.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree Phenology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="tree-phenology.html"><a href="tree-phenology.html"><i class="fa fa-check"></i><b>2</b> Tree phenology</a></li>
<li class="chapter" data-level="3" data-path="treedormancy.html"><a href="treedormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a><ul>
<li class="chapter" data-level="3.1" data-path="treedormancy.html"><a href="treedormancy.html#task-1"><i class="fa fa-check"></i><b>3.1</b> Task 1</a></li>
<li class="chapter" data-level="3.2" data-path="treedormancy.html"><a href="treedormancy.html#task-2"><i class="fa fa-check"></i><b>3.2</b> Task 2</a></li>
<li class="chapter" data-level="3.3" data-path="treedormancy.html"><a href="treedormancy.html#task-3"><i class="fa fa-check"></i><b>3.3</b> Task 3</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a><ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#task-1-1"><i class="fa fa-check"></i><b>4.1</b> Task 1</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#task-2-1"><i class="fa fa-check"></i><b>4.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html"><i class="fa fa-check"></i><b>5</b> Manual Chill Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#task-1-2"><i class="fa fa-check"></i><b>5.1</b> Task 1</a></li>
<li class="chapter" data-level="5.2" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#task-2-2"><i class="fa fa-check"></i><b>5.2</b> Task 2</a></li>
<li class="chapter" data-level="5.3" data-path="manual-chill-analysis.html"><a href="manual-chill-analysis.html#task-3-1"><i class="fa fa-check"></i><b>5.3</b> Task 3</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chill-models.html"><a href="chill-models.html"><i class="fa fa-check"></i><b>6</b> Chill Models</a><ul>
<li class="chapter" data-level="6.1" data-path="chill-models.html"><a href="chill-models.html#task-1-3"><i class="fa fa-check"></i><b>6.1</b> Task 1</a></li>
<li class="chapter" data-level="6.2" data-path="chill-models.html"><a href="chill-models.html#task2"><i class="fa fa-check"></i><b>6.2</b> Task2</a></li>
<li class="chapter" data-level="6.3" data-path="chill-models.html"><a href="chill-models.html#task3"><i class="fa fa-check"></i><b>6.3</b> Task3</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>7</b> Making hourly temperatures</a><ul>
<li class="chapter" data-level="7.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#task-1-4"><i class="fa fa-check"></i><b>7.1</b> Task 1</a></li>
<li class="chapter" data-level="7.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#task-2-3"><i class="fa fa-check"></i><b>7.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>8</b> Getting temperature data</a><ul>
<li class="chapter" data-level="8.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#task-1-5"><i class="fa fa-check"></i><b>8.1</b> Task 1</a></li>
<li class="chapter" data-level="8.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#task-2-4"><i class="fa fa-check"></i><b>8.2</b> Task 2</a></li>
<li class="chapter" data-level="8.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#task-3-2"><i class="fa fa-check"></i><b>8.3</b> Task 3</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html"><i class="fa fa-check"></i><b>9</b> Filling gaps in temperature records</a><ul>
<li class="chapter" data-level="9.1" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#task-1-6"><i class="fa fa-check"></i><b>9.1</b> Task 1</a></li>
<li class="chapter" data-level="9.2" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#task-2-5"><i class="fa fa-check"></i><b>9.2</b> Task 2</a></li>
<li class="chapter" data-level="9.3" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#task-3-3"><i class="fa fa-check"></i><b>9.3</b> Task 3</a></li>
<li class="chapter" data-level="9.4" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#task-4"><i class="fa fa-check"></i><b>9.4</b> Task 4</a></li>
<li class="chapter" data-level="9.5" data-path="filling-gaps-in-temperature-records.html"><a href="filling-gaps-in-temperature-records.html#task-5"><i class="fa fa-check"></i><b>9.5</b> Task 5</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html"><i class="fa fa-check"></i><b>10</b> Generating temperature scenarios</a><ul>
<li class="chapter" data-level="10.1" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#task-1-7"><i class="fa fa-check"></i><b>10.1</b> Task 1</a></li>
<li class="chapter" data-level="10.2" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#task-2-6"><i class="fa fa-check"></i><b>10.2</b> Task 2</a></li>
<li class="chapter" data-level="10.3" data-path="generating-temperature-scenarios.html"><a href="generating-temperature-scenarios.html#task-3-4"><i class="fa fa-check"></i><b>10.3</b> Task 3</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="historic-temperature-scenario.html"><a href="historic-temperature-scenario.html"><i class="fa fa-check"></i><b>11</b> Historic Temperature Scenario</a><ul>
<li class="chapter" data-level="11.1" data-path="historic-temperature-scenario.html"><a href="historic-temperature-scenario.html#task-1-8"><i class="fa fa-check"></i><b>11.1</b> Task 1</a></li>
<li class="chapter" data-level="11.2" data-path="historic-temperature-scenario.html"><a href="historic-temperature-scenario.html#task-2-7"><i class="fa fa-check"></i><b>11.2</b> Task 2</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html"><i class="fa fa-check"></i><b>12</b> Future Temperature Scenarios</a><ul>
<li class="chapter" data-level="12.1" data-path="future-temperature-scenarios.html"><a href="future-temperature-scenarios.html#task-1-9"><i class="fa fa-check"></i><b>12.1</b> Task 1</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="plotting-future-scenarios.html"><a href="plotting-future-scenarios.html"><i class="fa fa-check"></i><b>13</b> Plotting Future Scenarios</a><ul>
<li class="chapter" data-level="13.1" data-path="plotting-future-scenarios.html"><a href="plotting-future-scenarios.html#task-1-10"><i class="fa fa-check"></i><b>13.1</b> Task 1</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html"><i class="fa fa-check"></i><b>14</b> Chill Model Comparison</a><ul>
<li class="chapter" data-level="14.1" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html#task-1-11"><i class="fa fa-check"></i><b>14.1</b> Task 1</a></li>
<li class="chapter" data-level="14.2" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html#task-2-8"><i class="fa fa-check"></i><b>14.2</b> Task 2</a></li>
<li class="chapter" data-level="14.3" data-path="chill-model-comparison.html"><a href="chill-model-comparison.html#task-3-5"><i class="fa fa-check"></i><b>14.3</b> Task 3</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="heatmaps.html"><a href="heatmaps.html"><i class="fa fa-check"></i><b>15</b> Heatmaps</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning LogBook Tree phenology analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="heatmaps" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 15</span> Heatmaps<a href="heatmaps.html#heatmaps" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>In the previous lecture, the concept of chill and the expected changes were effectively demonstrated using heatmaps. In this chapter, this visualization method is utilized to depict the temperature measurements taken in July 2022 at the weather station in ZÃ¼lpich-Fuessenich. Preprocessing is necessary for this purpose. One challenge involves categorizing the temperatures into classes. To gain an understanding of how the classes can be set within the temperature data, one can initially use the <code>make_classes</code> function to get an overview.</p>
</blockquote>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="heatmaps.html#cb82-1"></a>make_classes &lt;-<span class="st"> </span><span class="cf">function</span>(data, scale_) {</span>
<span id="cb82-2"><a href="heatmaps.html#cb82-2"></a>  data &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(data)</span>
<span id="cb82-3"><a href="heatmaps.html#cb82-3"></a>  min =<span class="st"> </span><span class="kw">min</span>(data) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb82-4"><a href="heatmaps.html#cb82-4"></a>  max =<span class="st"> </span><span class="kw">max</span>(data)</span>
<span id="cb82-5"><a href="heatmaps.html#cb82-5"></a>  sacle =<span class="st"> </span>scale_</span>
<span id="cb82-6"><a href="heatmaps.html#cb82-6"></a>  end =<span class="st"> </span><span class="kw">round</span>(((max <span class="op">-</span><span class="st"> </span>min) <span class="op">/</span><span class="st"> </span>sacle))</span>
<span id="cb82-7"><a href="heatmaps.html#cb82-7"></a>  </span>
<span id="cb82-8"><a href="heatmaps.html#cb82-8"></a>  data[, <span class="st">&quot;class&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb82-9"><a href="heatmaps.html#cb82-9"></a>  </span>
<span id="cb82-10"><a href="heatmaps.html#cb82-10"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(data[, <span class="dv">1</span>]))) {</span>
<span id="cb82-11"><a href="heatmaps.html#cb82-11"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>, (end <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))) {</span>
<span id="cb82-12"><a href="heatmaps.html#cb82-12"></a>      <span class="cf">if</span> (data[, <span class="dv">1</span>][i,] <span class="op">&gt;</span><span class="st"> </span>(min <span class="op">+</span><span class="st"> </span>end <span class="op">*</span><span class="st"> </span>sacle)) {</span>
<span id="cb82-13"><a href="heatmaps.html#cb82-13"></a>        data[, <span class="st">&quot;class&quot;</span>][i,] =<span class="st">  </span><span class="kw">paste</span>((min <span class="op">+</span><span class="st"> </span>end <span class="op">*</span><span class="st"> </span>sacle),<span class="st">&quot; &gt;&quot;</span>)</span>
<span id="cb82-14"><a href="heatmaps.html#cb82-14"></a>        <span class="cf">break</span></span>
<span id="cb82-15"><a href="heatmaps.html#cb82-15"></a>      }</span>
<span id="cb82-16"><a href="heatmaps.html#cb82-16"></a>      </span>
<span id="cb82-17"><a href="heatmaps.html#cb82-17"></a>      <span class="cf">if</span> (data[, <span class="dv">1</span>][i,] <span class="op">&gt;=</span><span class="st"> </span>(min <span class="op">+</span><span class="st"> </span>(j <span class="op">*</span><span class="st"> </span>sacle))  <span class="op">&amp;&amp;</span></span>
<span id="cb82-18"><a href="heatmaps.html#cb82-18"></a><span class="st">          </span>data[, <span class="dv">1</span>][i,] <span class="op">&lt;=</span><span class="st"> </span>((min <span class="op">+</span><span class="st"> </span>sacle) <span class="op">+</span><span class="st"> </span>(j <span class="op">*</span><span class="st"> </span>sacle))) {</span>
<span id="cb82-19"><a href="heatmaps.html#cb82-19"></a>        data[, <span class="st">&quot;class&quot;</span>][i,] =<span class="st"> </span><span class="kw">paste</span>((min <span class="op">+</span><span class="st"> </span>(j <span class="op">*</span><span class="st"> </span>sacle)),<span class="st">&quot;-&quot;</span>,</span>
<span id="cb82-20"><a href="heatmaps.html#cb82-20"></a>                                    ((min <span class="op">+</span><span class="st"> </span>sacle) <span class="op">+</span><span class="st"> </span>(j <span class="op">*</span><span class="st"> </span>sacle)))</span>
<span id="cb82-21"><a href="heatmaps.html#cb82-21"></a>        <span class="cf">break</span></span>
<span id="cb82-22"><a href="heatmaps.html#cb82-22"></a>      }</span>
<span id="cb82-23"><a href="heatmaps.html#cb82-23"></a>    }</span>
<span id="cb82-24"><a href="heatmaps.html#cb82-24"></a>  }</span>
<span id="cb82-25"><a href="heatmaps.html#cb82-25"></a>  <span class="kw">return</span>(<span class="kw">list</span>(data, </span>
<span id="cb82-26"><a href="heatmaps.html#cb82-26"></a>              <span class="kw">unique</span>(data[,<span class="st">&quot;class&quot;</span>]),</span>
<span id="cb82-27"><a href="heatmaps.html#cb82-27"></a>              <span class="kw">table</span>(data[,<span class="st">&quot;class&quot;</span>])))</span>
<span id="cb82-28"><a href="heatmaps.html#cb82-28"></a>}</span></code></pre></div>
<blockquote>
<p>First letâs load some Data</p>
</blockquote>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="heatmaps.html#cb83-1"></a>weather_fue &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;/Users/Phil/Documents/Auswertung_Manuel_Juli_22/temp_hum_pres08.08.22.csv&quot;</span>)</span>
<span id="cb83-2"><a href="heatmaps.html#cb83-2"></a></span>
<span id="cb83-3"><a href="heatmaps.html#cb83-3"></a>mod_weather_fue &lt;-</span>
<span id="cb83-4"><a href="heatmaps.html#cb83-4"></a><span class="st">  </span>weather_fue <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="st">&quot;2022-07-01 00:00:00&quot;</span> <span class="op">&lt;</span><span class="st"> </span>date) <span class="op">%&gt;%</span></span>
<span id="cb83-5"><a href="heatmaps.html#cb83-5"></a><span class="st">  </span><span class="kw">filter</span>(<span class="st">&quot;2022-08-01 00:00:00&quot;</span> <span class="op">&gt;</span><span class="st"> </span>date) <span class="op">%&gt;%</span></span>
<span id="cb83-6"><a href="heatmaps.html#cb83-6"></a><span class="st">  </span><span class="kw">select</span>(temperature, period, type, date, sensor) <span class="op">%&gt;%</span></span>
<span id="cb83-7"><a href="heatmaps.html#cb83-7"></a><span class="st">  </span><span class="kw">filter</span>(period <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, type <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, sensor <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<blockquote>
<p>The function <code>make_classes()</code> is not part of the <code>chillR</code> package, and has thus been implemented here. It does not accept any data field as input. The temperatures must be passed directly, similar to the <code>max()</code> function, which is implemented by default in R. The <code>scale_</code> argument must be used to specify the class width. A small demonstration of the function will be shown below.</p>
<p>The function returns a list with multiple elements. The first list entry simply returns all the formed classes. The second entry provides an overview of the classes that were used. The third entry shows how frequently each class is represented.</p>
</blockquote>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="heatmaps.html#cb84-1"></a>df =<span class="st"> </span>mod_weather_fue</span>
<span id="cb84-2"><a href="heatmaps.html#cb84-2"></a>df[, <span class="st">&quot;class&quot;</span>] =<span class="st"> </span><span class="kw">make_classes</span>(df<span class="op">$</span>temperature, <span class="dt">scale_ =</span> <span class="dv">2</span>)[[<span class="dv">1</span>]][, <span class="dv">2</span>]</span>
<span id="cb84-3"><a href="heatmaps.html#cb84-3"></a></span>
<span id="cb84-4"><a href="heatmaps.html#cb84-4"></a><span class="kw">kable</span>(df[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>,], <span class="dt">caption =</span> <span class="st">&quot;Dataset Weather Fuessenich with Classes&quot;</span>)  <span class="op">%&gt;%</span></span>
<span id="cb84-5"><a href="heatmaps.html#cb84-5"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;left&quot;</span>,<span class="dt">font_size =</span> <span class="dv">10</span>)<span class="op">%&gt;%</span></span>
<span id="cb84-6"><a href="heatmaps.html#cb84-6"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="font-size: 10px; ">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-71">Table 15.1: </span>Dataset Weather Fuessenich with Classes
</caption>
<thead>
<tr>
<th style="text-align:right;">
temperature
</th>
<th style="text-align:right;">
period
</th>
<th style="text-align:right;">
type
</th>
<th style="text-align:left;">
date
</th>
<th style="text-align:right;">
sensor
</th>
<th style="text-align:left;">
class
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
13.760000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-06-30 23:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
13.235 - 15.235
</td>
</tr>
<tr>
<td style="text-align:right;">
13.698333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 00:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
13.235 - 15.235
</td>
</tr>
<tr>
<td style="text-align:right;">
13.351667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 01:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
13.235 - 15.235
</td>
</tr>
<tr>
<td style="text-align:right;">
12.951667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 02:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
12.410000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 03:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
11.958333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 04:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
11.673333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 05:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
11.923333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 06:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
12.876667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 07:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
14.400000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 08:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
13.235 - 15.235
</td>
</tr>
<tr>
<td style="text-align:right;">
15.526667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 09:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
15.235 - 17.235
</td>
</tr>
<tr>
<td style="text-align:right;">
17.248333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 10:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
17.235 - 19.235
</td>
</tr>
<tr>
<td style="text-align:right;">
17.821667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 11:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
17.235 - 19.235
</td>
</tr>
<tr>
<td style="text-align:right;">
17.816667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 12:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
17.235 - 19.235
</td>
</tr>
<tr>
<td style="text-align:right;">
18.958333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 13:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
17.235 - 19.235
</td>
</tr>
<tr>
<td style="text-align:right;">
19.556667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 14:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
19.235 - 21.235
</td>
</tr>
<tr>
<td style="text-align:right;">
19.698333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 15:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
19.235 - 21.235
</td>
</tr>
<tr>
<td style="text-align:right;">
20.330000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 16:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
19.235 - 21.235
</td>
</tr>
<tr>
<td style="text-align:right;">
21.313333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 17:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
21.235 - 23.235
</td>
</tr>
<tr>
<td style="text-align:right;">
20.411667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 18:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
19.235 - 21.235
</td>
</tr>
<tr>
<td style="text-align:right;">
19.918333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 19:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
19.235 - 21.235
</td>
</tr>
<tr>
<td style="text-align:right;">
20.028333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 20:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
19.235 - 21.235
</td>
</tr>
<tr>
<td style="text-align:right;">
17.160000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 21:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
15.235 - 17.235
</td>
</tr>
<tr>
<td style="text-align:right;">
14.213333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 22:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
13.235 - 15.235
</td>
</tr>
<tr>
<td style="text-align:right;">
12.551667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-01 23:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
12.090000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-02 00:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
11.640000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-02 01:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
11.235 - 13.235
</td>
</tr>
<tr>
<td style="text-align:right;">
11.148333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-02 02:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
9.235 - 11.235
</td>
</tr>
<tr>
<td style="text-align:right;">
10.598333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-02 03:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
9.235 - 11.235
</td>
</tr>
<tr>
<td style="text-align:right;">
9.701667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
2022-07-02 04:00:00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
9.235 - 11.235
</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>In this case, a new column named <code>class</code> is first written in the dataframe <code>df</code>. The generated classes are then directly written into this column. The formed classes can now be read in the table âDataset Weather Fuessenich with Classesâ in the <code>class</code> column.</p>
<p>At this point, it must be noted that the current approach is for orientational purposes only. In this particular case, the class boundaries will be manually generated at a later time using the <code>mutate()</code> function from the <code>tidyverse</code> package. The overall goal is to later provide a function that integrates the <code>make_classes()</code> function and automatically creates a heatmap that can be dynamically modified.</p>
</blockquote>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="heatmaps.html#cb85-1"></a><span class="co"># preprocessing </span></span>
<span id="cb85-2"><a href="heatmaps.html#cb85-2"></a></span>
<span id="cb85-3"><a href="heatmaps.html#cb85-3"></a><span class="co"># create column with date</span></span>
<span id="cb85-4"><a href="heatmaps.html#cb85-4"></a>mod_weather_fue[,<span class="st">&quot;date_new&quot;</span>] =<span class="st"> </span></span>
<span id="cb85-5"><a href="heatmaps.html#cb85-5"></a><span class="st">  </span><span class="kw">as.POSIXct</span>(mod_weather_fue<span class="op">$</span>date, <span class="dt">format =</span><span class="st">&quot;%m/%d/%Y %H:%M:%S&quot;</span> )</span>
<span id="cb85-6"><a href="heatmaps.html#cb85-6"></a></span>
<span id="cb85-7"><a href="heatmaps.html#cb85-7"></a><span class="co"># separate hours (time)</span></span>
<span id="cb85-8"><a href="heatmaps.html#cb85-8"></a>mod_weather_fue[, <span class="st">&quot;hours&quot;</span>] =</span>
<span id="cb85-9"><a href="heatmaps.html#cb85-9"></a><span class="st">  </span><span class="kw">format</span>(mod_weather_fue<span class="op">$</span>date_new, <span class="dt">format =</span> <span class="st">&quot;%H:%M:%S&quot;</span>)</span>
<span id="cb85-10"><a href="heatmaps.html#cb85-10"></a></span>
<span id="cb85-11"><a href="heatmaps.html#cb85-11"></a><span class="co"># pick only hours</span></span>
<span id="cb85-12"><a href="heatmaps.html#cb85-12"></a>mod_weather_fue[, <span class="st">&quot;hours_only&quot;</span>] =<span class="st"> </span></span>
<span id="cb85-13"><a href="heatmaps.html#cb85-13"></a><span class="st">  </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(mod_weather_fue<span class="op">$</span>hours, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb85-14"><a href="heatmaps.html#cb85-14"></a></span>
<span id="cb85-15"><a href="heatmaps.html#cb85-15"></a><span class="co"># delete first row (individual fix)</span></span>
<span id="cb85-16"><a href="heatmaps.html#cb85-16"></a>mod_weather_fue =<span class="st"> </span>mod_weather_fue[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>), ]</span>
<span id="cb85-17"><a href="heatmaps.html#cb85-17"></a></span>
<span id="cb85-18"><a href="heatmaps.html#cb85-18"></a><span class="co"># pick day </span></span>
<span id="cb85-19"><a href="heatmaps.html#cb85-19"></a>mod_weather_fue[, <span class="st">&quot;Tag&quot;</span>] =</span>
<span id="cb85-20"><a href="heatmaps.html#cb85-20"></a><span class="st">  </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(mod_weather_fue<span class="op">$</span>date, <span class="dv">9</span>, <span class="dv">10</span>))</span>
<span id="cb85-21"><a href="heatmaps.html#cb85-21"></a></span>
<span id="cb85-22"><a href="heatmaps.html#cb85-22"></a><span class="co"># set new col Index with NA </span></span>
<span id="cb85-23"><a href="heatmaps.html#cb85-23"></a>mod_weather_fue[,<span class="st">&quot;Index&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb85-24"><a href="heatmaps.html#cb85-24"></a></span>
<span id="cb85-25"><a href="heatmaps.html#cb85-25"></a>m3 &lt;-<span class="st"> </span>mod_weather_fue</span>
<span id="cb85-26"><a href="heatmaps.html#cb85-26"></a></span>
<span id="cb85-27"><a href="heatmaps.html#cb85-27"></a>m3[,<span class="st">&quot;countfactor&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb85-28"><a href="heatmaps.html#cb85-28"></a></span>
<span id="cb85-29"><a href="heatmaps.html#cb85-29"></a>m1 &lt;-m3 <span class="op">%&gt;%</span></span>
<span id="cb85-30"><a href="heatmaps.html#cb85-30"></a><span class="st">  </span><span class="co"># convert state to factor and reverse order of levels</span></span>
<span id="cb85-31"><a href="heatmaps.html#cb85-31"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Index=</span><span class="kw">factor</span>(Index, <span class="dt">levels=</span><span class="kw">rev</span>(<span class="kw">sort</span>(<span class="kw">unique</span>(Index)))))<span class="op">%&gt;%</span></span>
<span id="cb85-32"><a href="heatmaps.html#cb85-32"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">countfactor=</span><span class="kw">cut</span>(temperature, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">22</span>,</span>
<span id="cb85-33"><a href="heatmaps.html#cb85-33"></a>                                         <span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">28</span>,<span class="dv">30</span>,<span class="dv">32</span>,<span class="dv">34</span>,<span class="dv">36</span>, <span class="kw">max</span>(temperature, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)),</span>
<span id="cb85-34"><a href="heatmaps.html#cb85-34"></a>                         <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;8-10&quot;</span>, <span class="st">&quot;10-12&quot;</span>, <span class="st">&quot;12-14&quot;</span>, <span class="st">&quot;14-16&quot;</span>, <span class="st">&quot;16-18&quot;</span>, <span class="st">&quot;18-20&quot;</span>,</span>
<span id="cb85-35"><a href="heatmaps.html#cb85-35"></a>                                  <span class="st">&quot;20-22&quot;</span>,<span class="st">&quot;22-24&quot;</span>,<span class="st">&quot;24-26&quot;</span>,<span class="st">&quot;26-28&quot;</span>,<span class="st">&quot;28-30&quot;</span>,</span>
<span id="cb85-36"><a href="heatmaps.html#cb85-36"></a>                                  <span class="st">&quot;30-32&quot;</span>,<span class="st">&quot;32-34&quot;</span>,<span class="st">&quot;34-36&quot;</span>,<span class="st">&quot;36 &gt;&quot;</span>)))<span class="op">%&gt;%</span></span>
<span id="cb85-37"><a href="heatmaps.html#cb85-37"></a><span class="kw">mutate</span>(<span class="dt">countfactor=</span><span class="kw">factor</span>(<span class="kw">as.character</span>(countfactor), <span class="dt">levels=</span><span class="kw">rev</span>(<span class="kw">levels</span>(countfactor))))</span>
<span id="cb85-38"><a href="heatmaps.html#cb85-38"></a></span>
<span id="cb85-39"><a href="heatmaps.html#cb85-39"></a></span>
<span id="cb85-40"><a href="heatmaps.html#cb85-40"></a>colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#002565&quot;</span>, <span class="st">&quot;#00556E&quot;</span>, <span class="st">&quot;#007763&quot;</span>,</span>
<span id="cb85-41"><a href="heatmaps.html#cb85-41"></a>            <span class="st">&quot;#007F3A&quot;</span>, <span class="st">&quot;#00860D&quot;</span>,<span class="st">&quot;#198C00&quot;</span>,<span class="st">&quot;#519300&quot;</span>,<span class="st">&quot;#8B9803&quot;</span>,<span class="st">&quot;#9D7608&quot;</span>,<span class="st">&quot;#9A520B&quot;</span>,<span class="st">&quot;#98300D&quot;</span>,<span class="st">&quot;#951010&quot;</span>,<span class="st">&quot;#931231&quot;</span>,<span class="st">&quot;#901551&quot;</span>,<span class="st">&quot;#8B1A89&quot;</span>)</span>
<span id="cb85-42"><a href="heatmaps.html#cb85-42"></a>textcol &lt;-<span class="st"> &quot;grey40&quot;</span></span>
<span id="cb85-43"><a href="heatmaps.html#cb85-43"></a></span>
<span id="cb85-44"><a href="heatmaps.html#cb85-44"></a></span>
<span id="cb85-45"><a href="heatmaps.html#cb85-45"></a><span class="kw">ggplot</span>(m1, <span class="kw">aes</span>(<span class="dt">x=</span>hours_only , <span class="dt">y=</span>Tag, <span class="dt">fill=</span>countfactor ))<span class="op">+</span></span>
<span id="cb85-46"><a href="heatmaps.html#cb85-46"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size=</span><span class="fl">0.3</span>)<span class="op">+</span></span>
<span id="cb85-47"><a href="heatmaps.html#cb85-47"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span><span class="kw">round</span>(temperature, <span class="dt">digits =</span> <span class="dv">1</span>)), <span class="dt">size=</span><span class="fl">2.3</span>)<span class="op">+</span></span>
<span id="cb85-48"><a href="heatmaps.html#cb85-48"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">rev</span>(colors), <span class="dt">na.value =</span> <span class="st">&quot;grey90&quot;</span>)<span class="op">+</span></span>
<span id="cb85-49"><a href="heatmaps.html#cb85-49"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Temperatur in [Â°C]&quot;</span>))<span class="op">+</span></span>
<span id="cb85-50"><a href="heatmaps.html#cb85-50"></a><span class="st">  </span><span class="kw">theme_grey</span>(<span class="dt">base_size=</span><span class="dv">10</span>)<span class="op">+</span></span>
<span id="cb85-51"><a href="heatmaps.html#cb85-51"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Hour&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Day&quot;</span>)<span class="op">+</span></span>
<span id="cb85-52"><a href="heatmaps.html#cb85-52"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Hourly mean Temperatures in Juli 2022&quot;</span>)<span class="op">+</span></span>
<span id="cb85-53"><a href="heatmaps.html#cb85-53"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">legend.direction=</span><span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb85-54"><a href="heatmaps.html#cb85-54"></a>        <span class="dt">legend.title=</span><span class="kw">element_text</span>(<span class="dt">colour=</span>textcol),</span>
<span id="cb85-55"><a href="heatmaps.html#cb85-55"></a>        <span class="dt">legend.margin=</span><span class="kw">margin</span>(grid<span class="op">::</span><span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb85-56"><a href="heatmaps.html#cb85-56"></a>        <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">colour=</span>textcol, <span class="dt">size=</span><span class="dv">7</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb85-57"><a href="heatmaps.html#cb85-57"></a>        <span class="dt">legend.key.height=</span>grid<span class="op">::</span><span class="kw">unit</span>(<span class="fl">0.8</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb85-58"><a href="heatmaps.html#cb85-58"></a>        <span class="dt">legend.key.width=</span>grid<span class="op">::</span><span class="kw">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb85-59"><a href="heatmaps.html#cb85-59"></a>        <span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">colour=</span>textcol),</span>
<span id="cb85-60"><a href="heatmaps.html#cb85-60"></a>        <span class="dt">axis.text.y=</span><span class="kw">element_text</span>(<span class="dt">vjust=</span><span class="fl">0.2</span>, <span class="dt">colour=</span>textcol),</span>
<span id="cb85-61"><a href="heatmaps.html#cb85-61"></a>        <span class="dt">axis.ticks=</span><span class="kw">element_line</span>(<span class="dt">size=</span><span class="fl">0.4</span>),</span>
<span id="cb85-62"><a href="heatmaps.html#cb85-62"></a>        <span class="dt">plot.background=</span><span class="kw">element_blank</span>(),</span>
<span id="cb85-63"><a href="heatmaps.html#cb85-63"></a>        <span class="dt">panel.border=</span><span class="kw">element_blank</span>(),</span>
<span id="cb85-64"><a href="heatmaps.html#cb85-64"></a>        <span class="dt">plot.margin=</span><span class="kw">margin</span>(<span class="fl">0.7</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb85-65"><a href="heatmaps.html#cb85-65"></a>        <span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">colour=</span>textcol, <span class="dt">hjust=</span><span class="dv">0</span>, <span class="dt">size=</span><span class="dv">14</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb85-66"><a href="heatmaps.html#cb85-66"></a>  )<span class="op">+</span></span>
<span id="cb85-67"><a href="heatmaps.html#cb85-67"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">23</span>, <span class="dt">by =</span> <span class="dv">6</span>))<span class="op">+</span></span>
<span id="cb85-68"><a href="heatmaps.html#cb85-68"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">31</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="Tree-Phenology_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<blockquote>
<p>As seen, it can be somewhat tricky to save the final map in a suitable format. Therefore, the entire map was saved once, and the result was read in as a whole to maintain readability.</p>
</blockquote>
<div style="display: flex; justify-content: space-between;">
<p><img src="July_2022.png" style="max-width: 100%;" /></p>
</div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="chill-model-comparison.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/Heatmaps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Tree Phenology.pdf", "Tree Phenology.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toc_float": true,
"book_navbar": {
"collapse": true
}
});
});
</script>

</body>

</html>
